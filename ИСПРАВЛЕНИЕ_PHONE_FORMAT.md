# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞ Phone –¥–ª—è –°–ë–ü

**–î–∞—Ç–∞:** 19 –Ω–æ—è–±—Ä—è 2025  
**–ü—Ä–æ–±–ª–µ–º–∞:** –û—à–∏–±–∫–∞ 9999/322 –ø—Ä–∏ –≤—ã–≤–æ–¥–µ —Å—Ä–µ–¥—Å—Ç–≤

---

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞

–°–æ–≥–ª–∞—Å–Ω–æ –æ—Ç–≤–µ—Ç—É –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –¢-–ë–∞–Ω–∫–∞:

> **–ü–µ—Ä–µ–¥–∞–µ—Ç—Å—è 10 —Ü–∏—Ñ—Ä –≤–º–µ—Å—Ç–æ 11**

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

–ò–∑–º–µ–Ω–µ–Ω —Ñ–æ—Ä–º–∞—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `Phone` –¥–ª—è –≤—ã–ø–ª–∞—Ç —á–µ—Ä–µ–∑ –°–ë–ü.

### –ë—ã–ª–æ (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ):

```typescript
// –£–±–∏—Ä–∞–ª–∏ –∫–æ–¥ —Å—Ç—Ä–∞–Ω—ã "7" –≤ –Ω–∞—á–∞–ª–µ
const phoneForSbp = phone
	? phone.replace(/\D/g, '').replace(/^7/, '').slice(-10)
	: undefined

// –†–µ–∑—É–ª—å—Ç–∞—Ç: "9662765973" (10 —Ü–∏—Ñ—Ä) ‚ùå
```

### –°—Ç–∞–ª–æ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):

```typescript
// –û—Å—Ç–∞–≤–ª—è–µ–º –∫–æ–¥ —Å—Ç—Ä–∞–Ω—ã "7"
const phoneForSbp = phone ? phone.replace(/\D/g, '') : undefined

// –†–µ–∑—É–ª—å—Ç–∞—Ç: "79662765973" (11 —Ü–∏—Ñ—Ä) ‚úÖ
```

---

## üìã –ß—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–æ

### –§–∞–π–ª: `src/app/api/wallet/tbank/create-withdrawal/route.ts`

**–°—Ç—Ä–æ–∫–∞ 361-364:**

```typescript
// –î–ª—è –°–ë–ü Phone –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 11 —Ü–∏—Ñ—Ä –° –∫–æ–¥–æ–º —Å—Ç—Ä–∞–Ω—ã (7XXXXXXXXXX)
// –°–æ–≥–ª–∞—Å–Ω–æ –æ—Ç–≤–µ—Ç—É –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –¢-–ë–∞–Ω–∫–∞
const phoneForSbp = phone
	? phone.replace(/\D/g, '') // –£–±–∏—Ä–∞–µ–º –≤—Å–µ –Ω–µ—Ü–∏—Ñ—Ä–æ–≤—ã–µ —Å–∏–º–≤–æ–ª—ã
	: undefined
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:

- `–ù–ê–°–¢–†–û–ô–ö–ê_E2C_–¢–ï–†–ú–ò–ù–ê–õ–ê.md`

---

## üöÄ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
cd ~/nesi-app

# –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git pull

# –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ
npm run build

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ
sudo systemctl restart nesi-app.service

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
sudo journalctl -u nesi-app.service -f
```

---

## ‚úÖ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ –∑–∞–ø—Ä–æ—Å–µ –∫ –¢-–ë–∞–Ω–∫ –±—É–¥–µ—Ç:

**–ë—ã–ª–æ:**

```json
{
	"Phone": "9662765973",
	"SbpMemberId": "100000000004"
}
```

**–°—Ç–∞–ª–æ:**

```json
{
	"Phone": "79662765973",
	"SbpMemberId": "100000000004"
}
```

–ò –æ—à–∏–±–∫–∞ –¥–æ–ª–∂–Ω–∞ –∏—Å—á–µ–∑–Ω—É—Ç—å! üéâ

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–≤–µ—Å—Ç–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:

```bash
sudo journalctl -u nesi-app.service --since "1 minute ago" --no-pager | grep -E "Phone|CREATE-WITHDRAWAL|Success"
```

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:**

```
üí∏ [CREATE-WITHDRAWAL] –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤—ã–ø–ª–∞—Ç—ã: {
  phone: '79662765973',  ‚Üê ‚úÖ 11 —Ü–∏—Ñ—Ä
  sbpMemberId: '100000000004'
}
üì§ [TBANK] –°–æ–∑–¥–∞–Ω–∏–µ –≤—ã–ø–ª–∞—Ç—ã: {
  Phone: "79662765973",  ‚Üê ‚úÖ 11 —Ü–∏—Ñ—Ä
}
‚úÖ [TBANK] –í—ã–ø–ª–∞—Ç–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞
```

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ

–§–æ—Ä–º–∞—Ç —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–ª—è **–ø–æ–ø–æ–ª–Ω–µ–Ω–∏–π** –∏ **–≤—ã–≤–æ–¥** –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è:

- **PaymentRecipientId** (–¥–ª—è Init): `+79662765973` (—Å –ø–ª—é—Å–æ–º)
- **Phone** (–¥–ª—è –°–ë–ü): `79662765973` (–±–µ–∑ –ø–ª—é—Å–∞, 11 —Ü–∏—Ñ—Ä)

---

**–ì–æ—Ç–æ–≤–æ!** –ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—ã–ø–ª–∞—Ç—ã –¥–æ–ª–∂–Ω—ã –∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å! üöÄ
