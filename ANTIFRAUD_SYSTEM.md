# üõ°Ô∏è Anti-Fraud —Å–∏—Å—Ç–µ–º–∞ NESI

## üìã –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ NESI.

---

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### 1. **–í—Ä–µ–º–µ–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** ‚è∞
- **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞ —Å—Ä–æ–∫:** 7 –¥–Ω–µ–π / 30 –¥–Ω–µ–π / –Ω–∞–≤—Å–µ–≥–¥–∞
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–Ω—è—Ç–∏–µ** –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ —Å—Ä–æ–∫–∞
- **–ü—Ä–∏—á–∏–Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏** —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- **API:** `POST /api/admin/users/[id]/block`
  ```json
  {
    "duration": 7,  // –¥–Ω–µ–π (0 = –Ω–∞–≤—Å–µ–≥–¥–∞)
    "reason": "–ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã"
  }
  ```

### 2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (IP + –¥–µ–π—Å—Ç–≤–∏—è)** üìä
- **–ß—Ç–æ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è:**
  - –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥ (`login_success`)
  - –ü–æ–ø—ã—Ç–∫–∞ –≤—Ö–æ–¥–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`login_blocked`)
  - –£—Å–ø–µ—à–Ω—ã–π –≤—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤ (`withdraw_success`)
  - –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–≤–æ–¥ (`withdraw_blocked`)
- **–î–∞–Ω–Ω—ã–µ –≤ –ª–æ–≥–∞—Ö:**
  - IP-–∞–¥—Ä–µ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - User-Agent (–±—Ä–∞—É–∑–µ—Ä/—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ)
  - –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (—Å—É–º–º–∞, –ø—Ä–∏—á–∏–Ω–∞, –∏ —Ç.–¥.)
  - –í—Ä–µ–º—è –¥–µ–π—Å—Ç–≤–∏—è

### 3. **–ü—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ –≤—ã–≤–æ–¥–æ–º —Å—Ä–µ–¥—Å—Ç–≤** üí∏
- ‚úÖ **–ú–∏–Ω–∏–º—É–º 1 –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞** ‚Äî –Ω–µ–ª—å–∑—è –≤—ã–≤–µ—Å—Ç–∏ –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã
- ‚úÖ **–õ–∏–º–∏—Ç –¥–ª—è –Ω–æ–≤—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤** ‚Äî –º–∞–∫—Å–∏–º—É–º 5000‚ÇΩ –¥–ª—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –º–ª–∞–¥—à–µ 7 –¥–Ω–µ–π
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–ø–æ—Ä–æ–≤** ‚Äî –≤—ã–≤–æ–¥ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Å–ø–æ—Ä–∞—Ö
- ‚úÖ **–£—á–µ—Ç –∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤** ‚Äî –Ω–µ–ª—å–∑—è –≤—ã–≤–µ—Å—Ç–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞ –≤ —Ä–∞–±–æ—Ç–µ

### 4. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É** üö®
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã** –ø—Ä–∏:
  - –ù–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç (< 7 –¥–Ω–µ–π) –≤—ã–≤–æ–¥–∏—Ç > 3000‚ÇΩ
  - –õ—é–±—ã–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å–æ–¥–µ—Ä–∂–∞—Ç:**
  - Email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - –°—É–º–º–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏
  - –í–æ–∑—Ä–∞—Å—Ç –∞–∫–∫–∞—É–Ω—Ç–∞
  - –°—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### 5. **–í—ã—è–≤–ª–µ–Ω–∏–µ –∫—Ä—É–≥–æ–≤—ã—Ö —Å–¥–µ–ª–æ–∫** üîÑ
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑** –≤–∑–∞–∏–º–Ω—ã—Ö –∑–∞–¥–∞—á –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- **–ü–æ—Ä–æ–≥ "–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ":** 3+ –≤–∑–∞–∏–º–Ω—ã—Ö –∑–∞–¥–∞—á
- **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:**
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∑–∞–∏–º–Ω—ã—Ö –∑–∞–¥–∞—á
  - –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞–¥–∞—á —Å —Å—É–º–º–∞–º–∏ –∏ –¥–∞—Ç–∞–º–∏
  - –°—Å—ã–ª–∫–∏ –Ω–∞ –ø—Ä–æ—Ñ–∏–ª–∏ –æ–±–æ–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### 6. **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å Anti-Fraud** üñ•Ô∏è
- **URL:** `/admin/antifraud`
- **–í–∫–ª–∞–¥–∫–∞ "–õ–æ–≥–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏":**
  - –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - –§–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É –¥–µ–π—Å—Ç–≤–∏—è
  - IP-–∞–¥—Ä–µ—Å–∞ –∏ User-Agent
  - –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (—Å—É–º–º—ã, –ø—Ä–∏—á–∏–Ω—ã, –∏ —Ç.–¥.)
  - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ IP –∑–∞ 7 –¥–Ω–µ–π
- **–í–∫–ª–∞–¥–∫–∞ "–ö—Ä—É–≥–æ–≤—ã–µ —Å–¥–µ–ª–∫–∏":**
  - –°–ø–∏—Å–æ–∫ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∑–∞–∏–º–Ω—ã—Ö –∑–∞–¥–∞—á
  - –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–µ

---

## üìÇ –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã

### Backend:
- `src/lib/antifraud.ts` ‚Äî —É—Ç–∏–ª–∏—Ç—ã anti-fraud
  - `logActivity()` ‚Äî –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π
  - `sendAdminAlert()` ‚Äî —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω—É
  - `checkUserBlocked()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
  - `validateWithdrawal()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ –≤—ã–≤–æ–¥–æ–º
  - `detectCircularDeals()` ‚Äî –≤—ã—è–≤–ª–µ–Ω–∏–µ –∫—Ä—É–≥–æ–≤—ã—Ö —Å–¥–µ–ª–æ–∫

- `src/app/api/admin/activity-logs/route.ts` ‚Äî API –¥–ª—è –ª–æ–≥–æ–≤
- `src/app/api/admin/fraud-detection/route.ts` ‚Äî API –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞
- `src/app/api/admin/users/[id]/block/route.ts` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

### Frontend:
- `src/app/admin/antifraud/page.tsx` ‚Äî —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- `ANTIFRAUD_TESTING.md` ‚Äî –ø–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
- `ANTIFRAUD_SYSTEM.md` ‚Äî —ç—Ç–æ —Ñ–∞–π–ª

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:
- –ú–æ–¥–µ–ª—å `ActivityLog` ‚Äî –ª–æ–≥–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –ü–æ–ª—è `User.blockedUntil`, `User.blockedReason` ‚Äî –≤—Ä–µ–º–µ–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —É–∂–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∞ ‚úÖ
–ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ `npx prisma db push`.

### 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è

–î–æ–±–∞–≤—å—Ç–µ –≤ `.env`:
```env
PLATFORM_OWNER_ID=<–≤–∞—à-admin-user-id>
```

–ß—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å ID –∞–¥–º–∏–Ω–∞:
```sql
SELECT id FROM "User" WHERE role = 'admin' LIMIT 1;
```

### 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä
```bash
npm run dev
```

### 4. –û—Ç–∫—Ä–æ–π—Ç–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ `/admin/antifraud` –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É.

---

## üß™ –ö–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

–°–º–æ—Ç—Ä–∏—Ç–µ –ø–æ–ª–Ω—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –≤ —Ñ–∞–π–ª–µ **`ANTIFRAUD_TESTING.md`**.

### –ë—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã:

1. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ IP:**
   - –í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç
   - –û—Ç–∫—Ä–æ–π—Ç–µ `/admin/antifraud` ‚Üí –õ–æ–≥–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à IP –∑–∞–ø–∏—Å–∞–Ω

2. **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤—ã–≤–æ–¥–∞ –±–µ–∑ –∑–∞–¥–∞—á:**
   - –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–≤–µ—Å—Ç–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞
   - –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞: "–í—ã–≤–æ–¥ –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ–π –∑–∞–¥–∞—á–∏"

3. **–õ–∏–º–∏—Ç –¥–ª—è –Ω–æ–≤—ã—Ö:**
   - –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–≤–µ—Å—Ç–∏ > 5000‚ÇΩ –Ω–æ–≤—ã–º –∞–∫–∫–∞—É–Ω—Ç–æ–º
   - –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞: "–ù–æ–≤—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã –º–æ–≥—É—Ç –≤—ã–≤–æ–¥–∏—Ç—å –º–∞–∫—Å–∏–º—É–º 5000‚ÇΩ"

4. **–í—Ä–µ–º–µ–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞:**
   - –ó–∞–±–ª–æ–∫–∏—Ä—É–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ API
   - –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–æ–π—Ç–∏ ‚Äî –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞ —Å –¥–∞—Ç–æ–π —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

5. **–ö—Ä—É–≥–æ–≤—ã–µ —Å–¥–µ–ª–∫–∏:**
   - –°–æ–∑–¥–∞–π—Ç–µ 4 –∑–∞–¥–∞—á–∏ –º–µ–∂–¥—É –¥–≤—É–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (2 –≤ –∫–∞–∂–¥—É—é —Å—Ç–æ—Ä–æ–Ω—É)
   - –û—Ç–∫—Ä–æ–π—Ç–µ `/admin/antifraud` ‚Üí –ö—Ä—É–≥–æ–≤—ã–µ —Å–¥–µ–ª–∫–∏
   - –ü–∞—Ä–∞ –¥–æ–ª–∂–Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∫–∞–∫ "–ü–û–î–û–ó–†–ò–¢–ï–õ–¨–ù–û"

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ê–¥–º–∏–Ω –º–æ–∂–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å:
- **–ö—Ç–æ –∏ –∫–æ–≥–¥–∞ –≤—Ö–æ–¥–∏–ª** (—Å –∫–∞–∫–æ–≥–æ IP)
- **–ü–æ–ø—ã—Ç–∫–∏ –≤—ã–≤–æ–¥–∞ —Å—Ä–µ–¥—Å—Ç–≤** (—É—Å–ø–µ—à–Ω—ã–µ –∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ)
- **–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä—ã** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–¢–æ–ø-10 IP-–∞–¥—Ä–µ—Å–æ–≤** –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã:
- –ù–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç –≤—ã–≤–æ–¥–∏—Ç –±–æ–ª—å—à—É—é —Å—É–º–º—É ‚Üí –∞–¥–º–∏–Ω –ø–æ–ª—É—á–∏—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
- –ü–æ–ø—ã—Ç–∫–∞ –≤—Ö–æ–¥–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —é–∑–µ—Ä–∞ ‚Üí –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ß—Ç–æ –∑–∞—â–∏—â–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞:

1. **–û–±–Ω–∞–ª–∏—á–∏–≤–∞–Ω–∏–µ** ‚Äî –Ω–µ–ª—å–∑—è –≤—ã–≤–µ—Å—Ç–∏ –±–µ–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
2. **–ö—Ä—É–≥–æ–≤—ã–µ —Å—Ö–µ–º—ã** ‚Äî –≤—ã—è–≤–ª—è—é—Ç—Å—è –≤–∑–∞–∏–º–Ω—ã–µ –∑–∞–¥–∞—á–∏ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
3. **–ú–∞—Å—Å–æ–≤—ã–π –≤—ã–≤–æ–¥** ‚Äî –ª–∏–º–∏—Ç—ã –¥–ª—è –Ω–æ–≤—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤
4. **–í—ã–≤–æ–¥ –ø—Ä–∏ —Å–ø–æ—Ä–∞—Ö** ‚Äî –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –¥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
5. **–ù–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø** ‚Äî –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤—Å–µ –≤—Ö–æ–¥—ã —Å IP

### –ß—Ç–æ –ù–ï —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (–Ω–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å):

- ‚ùå VPN/Proxy –¥–µ—Ç–µ–∫—Ü–∏—è (–Ω—É–∂–µ–Ω –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å)
- ‚ùå KYC —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ (–Ω—É–∂–Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Sumsub/Onfido)
- ‚ùå AI —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- ‚ùå Rate limiting –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á
- ‚ùå –ü—Ä–æ–≤–µ—Ä–∫–∞ "–Ω–µ–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å—É–º–º" (–º–æ–∂–µ—Ç –±—ã—Ç—å –º–Ω–æ–≥–æ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π)

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:

1. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏** –≤ `/admin/antifraud` —Ä–µ–≥—É–ª—è—Ä–Ω–æ
2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ `PLATFORM_OWNER_ID`** –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–ª–µ—Ä—Ç–æ–≤
3. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ "–ö—Ä—É–≥–æ–≤—ã–µ —Å–¥–µ–ª–∫–∏"** —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é
4. **–ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ç–æ–ø IP-–∞–¥—Ä–µ—Å–æ–≤** ‚Äî –µ—Å–ª–∏ –æ–¥–∏–Ω IP = –º–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ ‚Üí –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ
5. **–ê–¥–∞–ø—Ç–∏—Ä—É–π—Ç–µ –ª–∏–º–∏—Ç—ã** –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:
   - –°–µ–π—á–∞—Å: 5000‚ÇΩ –¥–ª—è –Ω–æ–≤—ã—Ö (7 –¥–Ω–µ–π)
   - –ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ `src/lib/antifraud.ts` ‚Üí `validateWithdrawal()`

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

- –°–æ–±—Ä–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∑–∞ –ø–µ—Ä–≤—ã–π –º–µ—Å—è—Ü
- –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –ø–æ–¥ –≤–∞—à –±–∏–∑–Ω–µ—Å

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –æ—à–∏–±–∫–∏
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `PLATFORM_OWNER_ID` –Ω–∞—Å—Ç—Ä–æ–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∞ (`npx prisma db push`)
4. –°–º–æ—Ç—Ä–∏—Ç–µ `ANTIFRAUD_TESTING.md` –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

---

## ‚úÖ Checklist –¥–ª—è –¥–µ–ø–ª–æ—è

- [ ] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∞ (`npx prisma db push`)
- [ ] `PLATFORM_OWNER_ID` —É–∫–∞–∑–∞–Ω –≤ `.env`
- [ ] –°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
- [ ] –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å `/admin/antifraud` –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ IP —Ä–∞–±–æ—Ç–∞–µ—Ç (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –≤—Ö–æ–¥–æ–º)
- [ ] –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤—ã–≤–æ–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ —Ç–µ—Å—Ç–æ–º)
- [ ] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω—É —Ä–∞–±–æ—Ç–∞—é—Ç (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –±–æ–ª—å—à–∏–º –≤—ã–≤–æ–¥–æ–º)

---

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üöÄ**

