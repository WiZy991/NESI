# –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å DealId –ø—Ä–∏ –≤—ã–ø–ª–∞—Ç–∞—Ö

## üî¥ –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–∏ –±–∞–ª–∞–Ω—Å–∞ —á–µ—Ä–µ–∑ –¢-–ë–∞–Ω–∫ DealId –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è "DealId: N/A"), –∏–∑-–∑–∞ —á–µ–≥–æ –≤—ã–ø–ª–∞—Ç—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç, —Ç–∞–∫ –∫–∞–∫ DealId –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è –º—É–ª—å—Ç–∏—Ä–∞—Å—á–µ—Ç–æ–≤.

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ DealId –ø—Ä–∏ –≤—ã–≤–æ–¥–µ
- –°–∏—Å—Ç–µ–º–∞ –∏—â–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π DealId –∏–∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è
- –ï—Å–ª–∏ DealId –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å –µ–≥–æ –∏–∑ API –¥–ª—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–ª–∞—Ç–µ–∂–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é —Å –ø–æ–ª—É—á–µ–Ω–Ω—ã–º DealId

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ DealId –≤ –≤–µ–±—Ö—É–∫–µ
- –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –≤–µ–±—Ö—É–∫–∞ —Å–∏—Å—Ç–µ–º–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç DealId –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö
- –≠—Ç–æ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É, –∫–æ–≥–¥–∞ –≤–µ–±—Ö—É–∫ –ø—Ä–∏—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ DealId –ø—Ä–∏ —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–µ
- –ü—Ä–∏ —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–µ –ø–ª–∞—Ç–µ–∂–∞ —Å–∏—Å—Ç–µ–º–∞ –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å DealId –∏–∑ API
- –û–±–Ω–æ–≤–ª—è–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é —Å DealId, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ –±—ã–ª–æ

### 4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–∑–æ–≤ update-deal-ids
- –ü—Ä–∏ –≤—ã–≤–æ–¥–µ, –µ—Å–ª–∏ DealId –Ω–µ –Ω–∞–π–¥–µ–Ω, —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç API –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤—Å–µ—Ö DealId
- –≠—Ç–æ –ø–æ—Å–ª–µ–¥–Ω—è—è –ø–æ–ø—ã—Ç–∫–∞ –Ω–∞–π—Ç–∏ DealId –ø–µ—Ä–µ–¥ –æ—à–∏–±–∫–æ–π

## üîç –ü–æ—á–µ–º—É DealId –º–æ–∂–µ—Ç –±—ã—Ç—å NULL

1. **–í–µ–±—Ö—É–∫ –Ω–µ –ø—Ä–∏—à–µ–ª –∏–ª–∏ –ø—Ä–∏—à–µ–ª –ø–æ–∑–¥–Ω–æ**
   - –†–µ—à–µ–Ω–∏–µ: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –≤–µ–±—Ö—É–∫–∞

2. **GetState –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç DealId**
   - –†–µ—à–µ–Ω–∏–µ: –ø–æ–ø—ã—Ç–∫–∞ –ø–æ–ª—É—á–∏—Ç—å DealId –∏–∑ API –ø—Ä–∏ –≤—ã–≤–æ–¥–µ

3. **–°–¥–µ–ª–∫–∞ –Ω–µ –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞ –ø—Ä–∏ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–∏**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è `CreateDealWithType: 'NN'` (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)

## üìã –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ DealId –≤—Å–µ –µ—â–µ –Ω–µ –Ω–∞–π–¥–µ–Ω

1. **–ü–æ–¥–æ–∂–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç**
   - –í–µ–±—Ö—É–∫ –æ—Ç –¢-–ë–∞–Ω–∫–∞ –º–æ–∂–µ—Ç –ø—Ä–∏–π—Ç–∏ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
   - –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –≤–µ–±—Ö—É–∫–∞ DealId –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏—Ç—Å—è

2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–Ω–æ–ø–∫—É "–û–±–Ω–æ–≤–∏—Ç—å DealId"**
   - –í—ã–∑—ã–≤–∞–µ—Ç API `/api/wallet/tbank/update-deal-ids`
   - –û–±–Ω–æ–≤–ª—è–µ—Ç –≤—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –±–µ–∑ DealId

3. **–ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å –∑–∞–Ω–æ–≤–æ**
   - –°–æ–∑–¥–∞—Å—Ç –Ω–æ–≤—É—é —Å–¥–µ–ª–∫—É —Å DealId
   - –í–µ–±—Ö—É–∫ –¥–æ–ª–∂–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å DealId

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ü–æ—Ä—è–¥–æ–∫ –ø–æ–∏—Å–∫–∞ DealId –ø—Ä–∏ –≤—ã–≤–æ–¥–µ:
1. –ò—â–µ—Ç –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è —Å DealId
2. –ü—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å DealId –∏–∑ API –¥–ª—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–ª–∞—Ç–µ–∂–∞
3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç update-deal-ids
4. –ü–æ–≤—Ç–æ—Ä–Ω–æ –∏—â–µ—Ç DealId –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ DealId:
- –í –≤–µ–±—Ö—É–∫–µ: –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ SpAccumulationId/DealId
- –ü—Ä–∏ —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–µ: –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∏–∑ –æ—Ç–≤–µ—Ç–∞ GetState
- –ü—Ä–∏ –≤—ã–≤–æ–¥–µ: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ API

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

- DealId –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è –≤—ã–ø–ª–∞—Ç –≤ —Ä–∞–º–∫–∞—Ö –º—É–ª—å—Ç–∏—Ä–∞—Å—á–µ—Ç–æ–≤
- DealId –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏–∑ —Ä–∞–Ω–µ–µ —Å–æ–∑–¥–∞–Ω–Ω–æ–π —Å–¥–µ–ª–∫–∏ (–ø—Ä–∏ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–∏)
- –î–ª—è –≤—ã–ø–ª–∞—Ç –ø–æ –°–ë–ü –º–µ—Ç–æ–¥ Payment –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
- –î–ª—è –≤—ã–ø–ª–∞—Ç –Ω–∞ –∫–∞—Ä—Ç—É —Ç—Ä–µ–±—É–µ—Ç—Å—è –º–µ—Ç–æ–¥ Payment

