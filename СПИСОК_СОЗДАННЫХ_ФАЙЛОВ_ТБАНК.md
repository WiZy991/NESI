# üìÅ –°–ø–∏—Å–æ–∫ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¢-–ë–∞–Ω–∫ –ú—É–ª—å—Ç–∏—Ä–∞—Å—á–µ—Ç—ã

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (—á–∏—Ç–∞–π—Ç–µ —ç—Ç–∏)

### 1. **–ù–ê–ß–ù–ò*–ó–î–ï–°–¨*–¢–ë–ê–ù–ö.md** ‚≠ê –ù–ê–ß–ù–ò–¢–ï –° –≠–¢–û–ì–û

–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –Ω–∞ –æ–¥–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ. 3 –∫–æ–º–∞–Ω–¥—ã, 5 –º–∏–Ω—É—Ç.

**–°–æ–¥–µ—Ä–∂–∏—Ç:**

- ‚úÖ 3 —à–∞–≥–∞ –ø–æ 2 –º–∏–Ω—É—Ç—ã –∫–∞–∂–¥—ã–π
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–µ–±—Ö—É–∫–∞
- ‚úÖ –†–µ—à–µ–Ω–∏–µ —á–∞—Å—Ç—ã—Ö –ø—Ä–æ–±–ª–µ–º

### 2. **–ë–´–°–¢–†–û–ï*–†–ï–®–ï–ù–ò–ï*–ü–†–û–ë–õ–ï–ú–´.md**

–≠–∫—Å–ø—Ä–µ—Å—Å-–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è —Å—Ä–æ—á–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è.

**–°–æ–¥–µ—Ä–∂–∏—Ç:**

- ‚úÖ –≠–∫—Å–ø—Ä–µ—Å—Å-—Ä–µ—à–µ–Ω–∏–µ –∑–∞ 5 –º–∏–Ω—É—Ç
- ‚úÖ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º
- ‚úÖ –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
- ‚úÖ –ß–µ–∫–ª–∏—Å—Ç

### 3. **–ù–ê–°–¢–†–û–ô–ö–ê*–¢–ë–ê–ù–ö*–ü–û–õ–ù–ê–Ø.md**

–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å–æ –≤—Å–µ–º–∏ –¥–µ—Ç–∞–ª—è–º–∏.

**–°–æ–¥–µ—Ä–∂–∏—Ç:**

- ‚úÖ –ü–æ—à–∞–≥–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏—è–º–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
- ‚úÖ –†–µ—à–µ–Ω–∏–µ –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º
- ‚úÖ –ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–∞–Ω–¥ –∏ –∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

---

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã

### 4. **–ö–û–ú–ê–ù–î–´*–î–õ–Ø*–ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø.md**

–ì–æ—Ç–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª.

**–°–æ–¥–µ—Ä–∂–∏—Ç:**

- ‚úÖ –ö–æ–º–∞–Ω–¥—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- ‚úÖ –ö–æ–º–∞–Ω–¥—ã –ø—Ä–æ–≤–µ—Ä–∫–∏
- ‚úÖ –ö–æ–º–∞–Ω–¥—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
- ‚úÖ –ö–æ–º–∞–Ω–¥—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 5. **README*–¢–ë–ê–ù–ö*–ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø.md**

–û–±—â–∞—è —Å–≤–æ–¥–∫–∞: —á—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ, —á—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å.

**–°–æ–¥–µ—Ä–∂–∏—Ç:**

- ‚úÖ –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º
- ‚úÖ –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- ‚úÖ –°—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### 6. **–®–ü–ê–†–ì–ê–õ–ö–ê_–¢–ë–ê–ù–ö.txt**

–ö—Ä–∞—Ç–∫–∞—è —à–ø–∞—Ä–≥–∞–ª–∫–∞ –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ.

**–°–æ–¥–µ—Ä–∂–∏—Ç:**

- ‚úÖ 3 –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–µ—à–µ–Ω–∏—è
- ‚úÖ –ö–æ–º–∞–Ω–¥—ã –ø—Ä–æ–≤–µ—Ä–∫–∏
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–µ–±—Ö—É–∫–∞
- ‚úÖ –ö–æ–Ω—Ç–∞–∫—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏

---

## üì¶ –§–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ —Å–∫—Ä–∏–ø—Ç—ã

### 7. **.env.example**

–ü—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è.

**–°–æ–¥–µ—Ä–∂–∏—Ç:**

- ‚úÖ –í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –¢-–ë–∞–Ω–∫–∞
- ‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º
- ‚úÖ –ü—Ä–∏–º–µ—Ä—ã –∑–Ω–∞—á–µ–Ω–∏–π

### 8. **scripts/check-tbank-setup.js**

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.

**–ü—Ä–æ–≤–µ—Ä—è–µ—Ç:**

- ‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä—É –ë–î
- ‚úÖ –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API –¢-–ë–∞–Ω–∫–∞
- ‚úÖ –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –≤–µ–±—Ö—É–∫–∞
- ‚úÖ –í—ã–≤–æ–¥–∏—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á–µ—Ç

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```bash
cd NESI
node scripts/check-tbank-setup.js
```

### 9. **prisma/migrations/20241119_add_dealid_paymentid/migration.sql**

SQL –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª–µ–π `dealId` –∏ `paymentId`.

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**

```bash
cd NESI
npx prisma migrate deploy
# –∏–ª–∏
psql $DATABASE_URL -f prisma/migrations/20241119_add_dealid_paymentid/migration.sql
```

---

## üìä –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ (5 –º–∏–Ω—É—Ç)

1. **[–ù–ê–ß–ù–ò*–ó–î–ï–°–¨*–¢–ë–ê–ù–ö.md](./–ù–ê–ß–ù–ò_–ó–î–ï–°–¨_–¢–ë–ê–ù–ö.md)** - —á–∏—Ç–∞–µ—Ç–µ –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç–µ
2. **–ì–æ—Ç–æ–≤–æ!**

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫

1. **[–ë–´–°–¢–†–û–ï*–†–ï–®–ï–ù–ò–ï*–ü–†–û–ë–õ–ï–ú–´.md](./–ë–´–°–¢–†–û–ï_–†–ï–®–ï–ù–ò–ï_–ü–†–û–ë–õ–ï–ú–´.md)** - –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
2. **[–ö–û–ú–ê–ù–î–´*–î–õ–Ø*–ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø.md](./–ö–û–ú–ê–ù–î–´_–î–õ–Ø_–ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø.md)** - –∫–æ–ø–∏—Ä—É–µ—Ç–µ –∫–æ–º–∞–Ω–¥—ã
3. **[–ù–ê–°–¢–†–û–ô–ö–ê*–¢–ë–ê–ù–ö*–ü–û–õ–ù–ê–Ø.md](./–ù–ê–°–¢–†–û–ô–ö–ê_–¢–ë–ê–ù–ö_–ü–û–õ–ù–ê–Ø.md)** - –µ—Å–ª–∏ –≤—Å–µ –µ—â–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –•–æ—á—É —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –ø–æ–¥—Ä–æ–±–Ω–æ

1. **[README*–¢–ë–ê–ù–ö*–ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø.md](./README_–¢–ë–ê–ù–ö_–ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø.md)** - –æ–±—â–∞—è —Å–≤–æ–¥–∫–∞
2. **[–ù–ê–°–¢–†–û–ô–ö–ê*–¢–ë–ê–ù–ö*–ü–û–õ–ù–ê–Ø.md](./–ù–ê–°–¢–†–û–ô–ö–ê_–¢–ë–ê–ù–ö_–ü–û–õ–ù–ê–Ø.md)** - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
3. **[multisplit.md](./multisplit.md)** - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¢-–ë–∞–Ω–∫–∞

---

## üéØ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
NESI/
‚îú‚îÄ‚îÄ üìÑ –ù–ê–ß–ù–ò_–ó–î–ï–°–¨_–¢–ë–ê–ù–ö.md              ‚Üê ‚≠ê –ù–ê–ß–ù–ò–¢–ï –û–¢–°–Æ–î–ê
‚îú‚îÄ‚îÄ üìÑ –ë–´–°–¢–†–û–ï_–†–ï–®–ï–ù–ò–ï_–ü–†–û–ë–õ–ï–ú–´.md       ‚Üê –≠–∫—Å–ø—Ä–µ—Å—Å-–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
‚îú‚îÄ‚îÄ üìÑ –ù–ê–°–¢–†–û–ô–ö–ê_–¢–ë–ê–ù–ö_–ü–û–õ–ù–ê–Ø.md         ‚Üê –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
‚îú‚îÄ‚îÄ üìÑ –ö–û–ú–ê–ù–î–´_–î–õ–Ø_–ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø.md        ‚Üê –ì–æ—Ç–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã
‚îú‚îÄ‚îÄ üìÑ README_–¢–ë–ê–ù–ö_–ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø.md       ‚Üê –û–±—â–∞—è —Å–≤–æ–¥–∫–∞
‚îú‚îÄ‚îÄ üìÑ –®–ü–ê–†–ì–ê–õ–ö–ê_–¢–ë–ê–ù–ö.txt               ‚Üê –ö—Ä–∞—Ç–∫–∞—è —à–ø–∞—Ä–≥–∞–ª–∫–∞
‚îú‚îÄ‚îÄ üìÑ –°–ü–ò–°–û–ö_–°–û–ó–î–ê–ù–ù–´–•_–§–ê–ô–õ–û–í_–¢–ë–ê–ù–ö.md  ‚Üê –í—ã –∑–¥–µ—Å—å
‚îú‚îÄ‚îÄ üìÑ .env.example                      ‚Üê –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ üìÅ scripts/
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ check-tbank-setup.js          ‚Üê –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
‚îî‚îÄ‚îÄ üìÅ prisma/
    ‚îî‚îÄ‚îÄ üìÅ migrations/
        ‚îî‚îÄ‚îÄ üìÅ 20241119_add_dealid_paymentid/
            ‚îî‚îÄ‚îÄ üìÑ migration.sql         ‚Üê SQL –º–∏–≥—Ä–∞—Ü–∏—è
```

---

## ‚úÖ –ö–æ–¥ —É–∂–µ –≥–æ—Ç–æ–≤!

**–í–∞–∂–Ω–æ:** –í—Å—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ –∫–æ–¥–µ. –≠—Ç–∏ —Ñ–∞–π–ª—ã —Å–æ–¥–µ—Ä–∂–∞—Ç —Ç–æ–ª—å–∫–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ.

**–ì–æ—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã –∫–æ–¥–∞:**

- `src/app/api/wallet/tbank/create-payment/route.ts` ‚úÖ
- `src/app/api/wallet/tbank/create-withdrawal/route.ts` ‚úÖ
- `src/app/api/wallet/tbank/webhook/route.ts` ‚úÖ
- `src/lib/tbank.ts` ‚úÖ

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**

1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
2. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –≤–µ–±—Ö—É–∫ –≤ –¢-–ë–∞–Ω–∫–µ

---

## üìñ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¢-–ë–∞–Ω–∫–∞ (—É–∂–µ –≤ –ø—Ä–æ–µ–∫—Ç–µ):

- **[multisplit.md](./multisplit.md)** - –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞ –ú—É–ª—å—Ç–∏—Ä–∞—Å—á–µ—Ç—ã
- **[oplata_multisplit.md](./oplata_multisplit.md)** - –ü—Ä–æ—Ç–æ–∫–æ–ª EACQ (–æ–ø–ª–∞—Ç—ã)
- **[vyplaty-multisplit.md](./vyplaty-multisplit.md)** - –ü—Ä–æ—Ç–æ–∫–æ–ª A2C (–≤—ã–ø–ª–∞—Ç—ã)

### –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã:

- **[TBANK_SETUP.md](./TBANK_SETUP.md)** - –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—é
- **[TBANK_DEALID_SETUP.md](./TBANK_DEALID_SETUP.md)** - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ DealId
- **[TBANK_TROUBLESHOOTING.md](./TBANK_TROUBLESHOOTING.md)** - –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å:**

1. –û—Ç–∫—Ä–æ–π—Ç–µ ‚Üí **[–ù–ê–ß–ù–ò*–ó–î–ï–°–¨*–¢–ë–ê–ù–ö.md](./–ù–ê–ß–ù–ò_–ó–î–ï–°–¨_–¢–ë–ê–ù–ö.md)**
2. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º (3 –∫–æ–º–∞–Ω–¥—ã)
3. –ì–æ—Ç–æ–≤–æ!

**–í—Ä–µ–º—è:** 5-10 –º–∏–Ω—É—Ç

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

**–¢-–ë–∞–Ω–∫:**

- Email: acq_help@tbank.ru
- –í–æ–ø—Ä–æ—Å: "–ü–æ—á–µ–º—É –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç SpAccumulationId –≤ –≤–µ–±—Ö—É–∫–µ?"

**–û–Ω–ª–∞–π–Ω-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**

- https://www.tbank.ru/kassa/dev/

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 19 –Ω–æ—è–±—Ä—è 2024  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤:** 9
