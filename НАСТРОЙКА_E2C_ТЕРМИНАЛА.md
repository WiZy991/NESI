# üè¶ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ E2C –¢–µ—Ä–º–∏–Ω–∞–ª–∞ –¥–ª—è –≤—ã–ø–ª–∞—Ç

**–î–∞—Ç–∞:** 19 –Ω–æ—è–±—Ä—è 2025

---

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û

–î–ª—è –≤—ã–ø–ª–∞—Ç (–≤—ã–≤–æ–¥–æ–≤ —Å—Ä–µ–¥—Å—Ç–≤) —Ç—Ä–µ–±—É–µ—Ç—Å—è **–æ—Ç–¥–µ–ª—å–Ω—ã–π E2C —Ç–µ—Ä–º–∏–Ω–∞–ª**, –æ—Ç–ª–∏—á–Ω—ã–π –æ—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–π (EACQ).

### –ü–æ—á–µ–º—É –æ—à–∏–±–∫–∞ 9999?

–û—à–∏–±–∫–∞ `9999` –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ:

1. E2C —Ç–µ—Ä–º–∏–Ω–∞–ª –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω
2. –ù–µ–≤–µ—Ä–Ω—ã–π `TBANK_E2C_TERMINAL_KEY`
3. –£ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –≤—ã–ø–ª–∞—Ç—ã
4. –¢–µ—Ä–º–∏–Ω–∞–ª –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –º—É–ª—å—Ç–∏—Ä–∞—Å—á–µ—Ç–∞–º

---

## üìã –®–∞–≥ 1: –ü–æ–ª—É—á–µ–Ω–∏–µ E2C –¢–µ—Ä–º–∏–Ω–∞–ª–∞

### 1.1 –ó–∞–ø—Ä–æ—Å E2C —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –≤ –¢-–ë–∞–Ω–∫–µ

–ù–∞–ø–∏—à–∏—Ç–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É –¢-–ë–∞–Ω–∫–∞:

**–ö–æ–º—É:** acq_help@tbank.ru  
**–¢–µ–º–∞:** –ó–∞–ø—Ä–æ—Å E2C —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –¥–ª—è –≤—ã–ø–ª–∞—Ç  
**–¢–µ–∫—Å—Ç:**

```
–î–æ–±—Ä—ã–π –¥–µ–Ω—å!

–ü—Ä–æ—à—É –ø–æ–¥–∫–ª—é—á–∏—Ç—å E2C —Ç–µ—Ä–º–∏–Ω–∞–ª –¥–ª—è –≤—ã–ø–ª–∞—Ç (A2C_V2) —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π:
- –°–ë–ü (–°–∏—Å—Ç–µ–º–∞ –±—ã—Å—Ç—Ä—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π)
- –í—ã–ø–ª–∞—Ç –Ω–∞ –∫–∞—Ä—Ç—ã
- –ú—É–ª—å—Ç–∏—Ä–∞—Å—á–µ—Ç–æ–≤ (SpAccumulationId/DealId)

–¢–µ–∫—É—â–∏–π —Ç–µ—Ä–º–∏–Ω–∞–ª –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–π: 1763372956356
–¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤—ã–ø–ª–∞—Ç—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º FinalPayout.

–°–ø–∞—Å–∏–±–æ!
```

### 1.2 –ß—Ç–æ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ

–ü–æ—Å–ª–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è –≤—ã –ø–æ–ª—É—á–∏—Ç–µ:

- **E2C TerminalKey** (–Ω–∞–ø—Ä–∏–º–µ—Ä: `1763372956356E2C`)
- **E2C Password** (–¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤)
- –î–æ—Å—Ç—É–ø –∫ API –≤—ã–ø–ª–∞—Ç: `https://securepay.tinkoff.ru/e2c/v2/`

---

## üîß –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

### 2.1 –û—Ç–∫—Ä–æ–π—Ç–µ `.env` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
cd ~/nesi-app
nano .env
```

### 2.2 –î–æ–±–∞–≤—å—Ç–µ E2C –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

```env
# –¢–µ—Ä–º–∏–Ω–∞–ª –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–π (EACQ)
TBANK_TERMINAL_KEY="1763372956356"
TBANK_PASSWORD="–≤–∞—à_–ø–∞—Ä–æ–ª—å_eacq"

# –¢–µ—Ä–º–∏–Ω–∞–ª –¥–ª—è –≤—ã–ø–ª–∞—Ç (E2C) - –û–¢–î–ï–õ–¨–ù–´–ô!
TBANK_E2C_TERMINAL_KEY="1763372956356E2C"
TBANK_E2C_PASSWORD="–≤–∞—à_–ø–∞—Ä–æ–ª—å_e2c"

# –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
NEXT_PUBLIC_APP_URL="https://nesi.su"
```

‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –ü–∞—Ä–æ–ª–∏ –¥–ª—è EACQ –∏ E2C —Ç–µ—Ä–º–∏–Ω–∞–ª–æ–≤ **—Ä–∞–∑–Ω—ã–µ**!

### 2.3 –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ

```bash
# –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ: Ctrl+O, Enter, Ctrl+X

# –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
npm run build

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–ª—É–∂–±—É
sudo systemctl restart nesi-app.service

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
sudo journalctl -u nesi-app.service -f
```

---

## ‚úÖ –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### 3.1 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd ~/nesi-app
cat .env | grep TBANK

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 4 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
# TBANK_TERMINAL_KEY
# TBANK_PASSWORD
# TBANK_E2C_TERMINAL_KEY
# TBANK_E2C_PASSWORD
```

### 3.2 –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–≤–µ—Å—Ç–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞

1. –ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å (—á—Ç–æ–±—ã —Å–æ–∑–¥–∞–ª—Å—è DealId)
2. –î–æ–∂–¥–∏—Ç–µ—Å—å —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞—á–∏—Å–ª–µ–Ω–∏—è
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–≤–µ—Å—Ç–∏ 100‚ÇΩ —á–µ—Ä–µ–∑ –°–ë–ü

### 3.3 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏

```bash
sudo journalctl -u nesi-app.service --since "5 minutes ago" --no-pager | grep -E "CREATE-WITHDRAWAL|E2C|Success"
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**

```
‚úÖ [TBANK] –í—ã–ø–ª–∞—Ç–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞
‚úÖ [CREATE-WITHDRAWAL] –í—ã–ø–ª–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∞
PaymentId: XXXXXXXX
```

---

## üîç –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –û—à–∏–±–∫–∞ 9999

**–ü—Ä–∏—á–∏–Ω–∞:** E2C —Ç–µ—Ä–º–∏–Ω–∞–ª –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω  
**–†–µ—à–µ–Ω–∏–µ:** –°–≤—è–∂–∏—Ç–µ—Å—å —Å –¢-–ë–∞–Ω–∫–æ–º –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –û—à–∏–±–∫–∞ 322

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–≤–µ—Ä–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞  
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç Phone (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 11 —Ü–∏—Ñ—Ä: 7XXXXXXXXXX)

### –ü—Ä–æ–±–ª–µ–º–∞ 3: DealId not found

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ –±—ã–ª–æ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è  
**–†–µ—à–µ–Ω–∏–µ:** –°–Ω–∞—á–∞–ª–∞ –ø–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å —á–µ—Ä–µ–∑ –¢-–ë–∞–Ω–∫

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –ù–µ–≤–µ—Ä–Ω–∞—è –ø–æ–¥–ø–∏—Å—å

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–≤–µ—Ä–Ω—ã–π `TBANK_E2C_PASSWORD`  
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–æ–ª—å –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –¢-–ë–∞–Ω–∫–∞

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –¢-–ë–∞–Ω–∫–∞

- **Email:** acq_help@tbank.ru
- **–¢–µ–ª–µ—Ñ–æ–Ω:** 8 (800) 555-25-50
- **–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç:** https://business.tbank.ru/
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** https://www.tbank.ru/kassa/develop/api/

---

## üìä –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–ª—É–∂–±—ã
sudo systemctl status nesi-app.service

# –°–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
sudo journalctl -u nesi-app.service -f

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –æ—à–∏–±–∫–∏
sudo journalctl -u nesi-app.service -n 100 --no-pager | grep -i error

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—ã–ø–ª–∞—Ç—ã
sudo journalctl -u nesi-app.service --since "today" --no-pager | grep WITHDRAWAL

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å DealId
sudo journalctl -u nesi-app.service --since "today" --no-pager | grep DealId
```

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

- [ ] E2C —Ç–µ—Ä–º–∏–Ω–∞–ª –ø–æ–ª—É—á–µ–Ω –æ—Ç –¢-–ë–∞–Ω–∫–∞
- [ ] `TBANK_E2C_TERMINAL_KEY` –¥–æ–±–∞–≤–ª–µ–Ω –≤ `.env`
- [ ] `TBANK_E2C_PASSWORD` –¥–æ–±–∞–≤–ª–µ–Ω –≤ `.env`
- [ ] –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–µ—Ä–µ—Å–æ–±—Ä–∞–Ω–æ (`npm run build`)
- [ ] –°–ª—É–∂–±–∞ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω–∞ (`systemctl restart`)
- [ ] –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (DealId —Å–æ–∑–¥–∞–Ω)
- [ ] –¢–µ—Å—Ç–æ–≤—ã–π –≤—ã–≤–æ–¥ –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ E2C —Ç–µ—Ä–º–∏–Ω–∞–ª–∞, –≤—ã–ø–ª–∞—Ç—ã –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!
