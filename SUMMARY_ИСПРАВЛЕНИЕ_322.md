# üìù –°–≤–æ–¥–∫–∞: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ 322 –ø—Ä–∏ –≤—ã–≤–æ–¥–µ —á–µ—Ä–µ–∑ –°–ë–ü

## üîç –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –≤—ã–≤–µ—Å—Ç–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞ —á–µ—Ä–µ–∑ –°–ë–ü T-Bank API –≤–æ–∑–≤—Ä–∞—â–∞–ª –æ—à–∏–±–∫—É:

```
ErrorCode: 322
Message: "–ù–µ–≤–µ—Ä–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã"
```

## üéØ –ü—Ä–∏—á–∏–Ω–∞

–ü–∞—Ä–∞–º–µ—Ç—Ä `FinalPayout` –ø–µ—Ä–µ–¥–∞–≤–∞–ª—Å—è –∫–∞–∫ **boolean** (`true`), –∞ –Ω–µ –∫–∞–∫ **—Å—Ç—Ä–æ–∫–∞** (`"true"`).

–°–æ–≥–ª–∞—Å–Ω–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ T-Bank A2C_V2 (—Å—Ç—Ä. 903), —ç—Ç–æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å—Ç—Ä–æ–∫–æ–π.

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –ò–∑–º–µ–Ω–µ–Ω–æ –≤ —Ñ–∞–π–ª–µ `src/lib/tbank.ts` (—Å—Ç—Ä–æ–∫–∞ 355):

**–ë—ã–ª–æ:**

```typescript
requestBody.FinalPayout = true // ‚ùå Boolean
```

**–°—Ç–∞–ª–æ:**

```typescript
requestBody.FinalPayout = 'true' // ‚úÖ –°—Ç—Ä–æ–∫–∞
```

### –ò–∑–º–µ–Ω–µ–Ω–æ –≤ —Ñ–∞–π–ª–µ `test-signature.js` (—Å—Ç—Ä–æ–∫–∞ 17):

**–ë—ã–ª–æ:**

```javascript
FinalPayout: true,  // ‚ùå Boolean
```

**–°—Ç–∞–ª–æ:**

```javascript
FinalPayout: 'true',  // ‚úÖ –°—Ç—Ä–æ–∫–∞
```

## üìã –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –≤ –∑–∞–ø—Ä–æ—Å–µ –∫ API

**–ë—ã–ª–æ (—Å –æ—à–∏–±–∫–æ–π):**

```json
{
	"FinalPayout": true,
	"Token": "..."
}
```

**–°—Ç–∞–ª–æ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):**

```json
{
	"FinalPayout": "true",
	"Token": "..."
}
```

## üöÄ –ö–∞–∫ –ø—Ä–∏–º–µ–Ω–∏—Ç—å

### 1. –ó–∞—Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ):

```powershell
cd C:\Users\Perfercher\Desktop\nesi\NESI
git add .
git commit -m "fix: –∏–∑–º–µ–Ω–∏—Ç—å FinalPayout –Ω–∞ —Å—Ç—Ä–æ–∫—É –¥–ª—è T-Bank API"
git push origin main
```

### 2. –û–±–Ω–æ–≤–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
ssh your-server
cd ~/nesi-app
git pull origin main
npm run build
sudo systemctl restart nesi-app.service
```

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É:

1. –í–æ–π–¥–∏—Ç–µ –≤ –ø—Ä–æ—Ñ–∏–ª—å
2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–≤–µ—Å—Ç–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞ —á–µ—Ä–µ–∑ –°–ë–ü
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `sudo journalctl -u nesi-app.service -f`

## ‚úÖ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

- ‚úÖ –í—ã–ø–ª–∞—Ç—ã —á–µ—Ä–µ–∑ –°–ë–ü —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ T-Bank –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `Success: true`
- ‚úÖ –ë–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è
- ‚ùå –û—à–∏–±–∫–∞ 322 –±–æ–ª—å—à–µ –Ω–µ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï_FINALPAYOUT_STRING.md` - –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è
- `–ö–ê–ö_–ü–†–ò–ú–ï–ù–ò–¢–¨_–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï.md` - –ø–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é
- `vyplaty-multisplit.md` (—Å—Ç—Ä. 903) - –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è T-Bank

---

**–í—Ä–µ–º—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 20 –Ω–æ—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é
