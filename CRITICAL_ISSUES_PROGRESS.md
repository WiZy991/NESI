# –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º –ø—Ä–æ–±–ª–µ–º–∞–º

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ —Å–µ–≥–æ–¥–Ω—è

### 1. –ó–∞–º–µ–Ω–∞ console.log –Ω–∞ logger
- ‚úÖ –ó–∞–º–µ–Ω–µ–Ω–æ –≤ 13+ API endpoints:
  - `src/app/api/hire/sent/route.ts`
  - `src/app/api/hire/incoming/route.ts`
  - `src/app/api/upload/chat-file/route.ts`
  - `src/app/api/admin/disputes/[id]/resolve/route.ts`
  - `src/app/api/cert/attempts/submit/route.ts`
  - `src/app/api/my-tasks/[id]/plan/route.ts`
  - `src/app/api/my-tasks/[id]/note/route.ts`
  - `src/app/api/my-tasks/kanban/route.ts`
  - `src/app/api/community/[id]/route.ts`
- ‚ö†Ô∏è –û—Å—Ç–∞–ª–æ—Å—å ~55 —Ñ–∞–π–ª–æ–≤ —Å console.log –≤ API (–º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ)

### 2. Rate Limiting
- ‚úÖ –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –Ω–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö endpoints:
  - `/api/auth/login` - –µ—Å—Ç—å
  - `/api/auth/register` - –µ—Å—Ç—å
  - `/api/messages/send` - –µ—Å—Ç—å
  - `/api/feedback` - –µ—Å—Ç—å

### 3. –ü–∞–≥–∏–Ω–∞—Ü–∏—è
- ‚úÖ –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞:
  - `/api/chats` - –µ—Å—Ç—å (limit, offset)
  - `/api/tasks` - –µ—Å—Ç—å (page, limit)
  - `/api/notifications` - –µ—Å—Ç—å (page, limit)

### 4. –ò–Ω–¥–µ–∫—Å—ã –ë–î
- ‚úÖ –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ `prisma/schema.prisma`
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞: `prisma/migrations/add_performance_indexes/migration.sql`
- ‚ö†Ô∏è –ù—É–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–µ—Å–ª–∏ –µ—â–µ –Ω–µ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã)

## ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è N+1 –∑–∞–ø—Ä–æ—Å–æ–≤

- ‚úÖ `/api/responses/my` - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω:
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏—è (page, limit)
  - –ó–∞–º–µ–Ω–µ–Ω `include` –Ω–∞ `select` –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è N+1
  - –ó–∞–º–µ–Ω–µ–Ω `console.error` –Ω–∞ `logger`
  
- ‚úÖ `/api/community/[id]/comment` - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω:
  - –£–±—Ä–∞–Ω–∞ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è `getReplies` —Å N+1 –∑–∞–ø—Ä–æ—Å–∞–º–∏
  - –í—Å–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –æ–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º
  - –î–µ—Ä–µ–≤–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ —Å—Ç—Ä–æ–∏—Ç—Å—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞

- ‚úÖ `/api/tasks/[id]` - —É–∂–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç avgRating)
- ‚úÖ `/api/profile` - —É–∂–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω (–æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç reviewsReceived)
- ‚úÖ `/api/users/[id]` - —É–∂–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç Promise.all –∏ select)
- ‚úÖ `/api/my-tasks` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏—è (–º–∞–∫—Å–∏–º—É–º 100 –∑–∞–¥–∞—á –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 50)

## üìã –ß—Ç–æ –µ—â–µ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–∫—Ä–∏—Ç–∏—á–Ω–æ)

1. **–ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –ë–î –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ**
   ```bash
   # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –ª–∏ –∏–Ω–¥–µ–∫—Å—ã
   psql -U nesi_user -d nesi_db -h localhost -c "SELECT tablename, indexname FROM pg_indexes WHERE schemaname = 'public' AND indexname LIKE 'idx_%' ORDER BY tablename;"
   
   # –ï—Å–ª–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã, –≤—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
   psql -U nesi_user -d nesi_db -h localhost < prisma/migrations/add_performance_indexes/migration.sql
   ```

2. **–£–ª—É—á—à–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**
   - ‚úÖ `/api/responses` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ Zod –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏—è
   - ‚úÖ `/api/tasks/[id]/report` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª–∏–Ω—ã reason –∏ description
   - ‚úÖ `/api/hire` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ Zod –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è executorId –∏ message (–º–∞–∫—Å–∏–º—É–º 2000 —Å–∏–º–≤–æ–ª–æ–≤)
   - ‚úÖ `/api/tasks/[id]/assign` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è executorId
   - –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –¥—Ä—É–≥–∏—Ö endpoints —É–∂–µ –∏–º–µ—é—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–≤–∞–∂–Ω–æ)

1. **–î–æ–±–∞–≤–∏—Ç—å rate limiting –Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ endpoints**
   - ‚úÖ `/api/tasks` (POST) - –¥–æ–±–∞–≤–ª–µ–Ω (5 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É)
   - ‚úÖ `/api/community` (POST) - –¥–æ–±–∞–≤–ª–µ–Ω (10 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É)
   - ‚úÖ `/api/responses` (POST) - –¥–æ–±–∞–≤–ª–µ–Ω (10 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É)

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ)

1. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ API**
   - ‚úÖ `/api/specialists` - —É–±—Ä–∞–Ω—ã N+1 –∑–∞–ø—Ä–æ—Å—ã (getLevelFromXP –≤—ã–∑—ã–≤–∞–ª—Å—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è), –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î, —Ä–∞—Å—á–µ—Ç —É—Ä–æ–≤–Ω–µ–π –≤ –ø–∞–º—è—Ç–∏

2. **–£–ª—É—á—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ —Å retry –º–µ—Ö–∞–Ω–∏–∑–º–∞–º–∏**
   - ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ —á–∞—Ç–æ–≤ (`/app/chats/page.tsx`) - –¥–æ–±–∞–≤–ª–µ–Ω retry (2 –ø–æ–ø—ã—Ç–∫–∏)
   - ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–∫–ª–∏–∫–∞ (`ResponseForm.tsx`) - –¥–æ–±–∞–≤–ª–µ–Ω retry —Å —É–º–Ω–æ–π –ª–æ–≥–∏–∫–æ–π (—Ç–æ–ª—å–∫–æ –¥–ª—è —Å–µ—Ç–µ–≤—ã—Ö/5xx –æ—à–∏–±–æ–∫)
   - ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞—á–∏ (`TaskDetailPageContent.tsx`) - –¥–æ–±–∞–≤–ª–µ–Ω retry –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–¥–∞—á–∏ –∏ —Å–ø–æ—Ä–∞
   - ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è (`/app/users/[id]/page.tsx`) - –¥–æ–±–∞–≤–ª–µ–Ω retry

3. **–£–ª—É—á—à–µ–Ω–∏–µ UX —Å skeleton loaders**
   - ‚úÖ `/app/tasks/page.tsx` - –¥–æ–±–∞–≤–ª–µ–Ω skeleton loader –≤–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
   - ‚úÖ `/app/cert/page.tsx` - –¥–æ–±–∞–≤–ª–µ–Ω skeleton loader –≤–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
   - `/app/chats/page.tsx` - —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç MessageSkeleton
   - `/app/users/[id]/page.tsx` - –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å skeleton loader –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–æ—Ñ–∏–ª—è

4. **–†–∞–∑–±–∏—Ç—å –±–æ–ª—å—à–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**
   - ‚úÖ Header.tsx - —É–∂–µ —Ä–∞–∑–±–∏—Ç
   - ‚úÖ ChatMessageInput.tsx - —á–∞—Å—Ç–∏—á–Ω–æ —Ä–∞–∑–±–∏—Ç (–µ—Å—Ç—å –ø–æ–¥–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, —Å–æ–∑–¥–∞–Ω —Ö—É–∫ useMessageSender)
   - ‚úÖ TaskDetailPageContent.tsx - –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–∑–±–∏—Ç –Ω–∞ 5 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:
     - ReviewSection.tsx
     - ResponsesSection.tsx
     - TaskActionsSection.tsx
     - ResponseFormSection.tsx
     - ChatLinkButton.tsx

2. **–î–æ–±–∞–≤–∏—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ**
   - –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ - —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (`src/lib/categoryCache.ts`)
   - –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å Redis –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞**
   - –î–æ–±–∞–≤–∏—Ç—å Sentry
   - –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **console.log –∑–∞–º–µ–Ω–µ–Ω–æ:** ~13 —Ñ–∞–π–ª–æ–≤
- **console.log –æ—Å—Ç–∞–ª–æ—Å—å:** ~55 —Ñ–∞–π–ª–æ–≤ –≤ API (–º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ)
- **Rate limiting:** 4 –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö endpoints –∑–∞—â–∏—â–µ–Ω—ã
- **–ü–∞–≥–∏–Ω–∞—Ü–∏—è:** 5 –æ—Å–Ω–æ–≤–Ω—ã—Ö endpoints –∏–º–µ—é—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏—é (chats, tasks, notifications, responses/my, my-tasks)
- **N+1 –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ:** 3 –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö endpoints (responses/my, community/[id]/comment, specialists)
- **–¢–∏–ø–∏–∑–∞—Ü–∏—è:** –°–æ–∑–¥–∞–Ω—ã —Ç–∏–ø—ã –¥–ª—è API responses, —É–ª—É—á—à–µ–Ω–∞ —Ç–∏–ø–∏–∑–∞—Ü–∏—è –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö endpoints
- **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –£–ª—É—á—à–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤ tasks/[id] PATCH, accept-executor, cancel, responses/[id]/status
- **–ò–Ω–¥–µ–∫—Å—ã –ë–î:** –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ schema, –º–∏–≥—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ:** –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –ë–î –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
2. **–í —Ç–µ—á–µ–Ω–∏–µ –Ω–µ–¥–µ–ª–∏:** –ó–∞–º–µ–Ω–∏—Ç—å –æ—Å—Ç–∞–≤—à–∏–µ—Å—è console.log –Ω–∞ logger
3. **–í —Ç–µ—á–µ–Ω–∏–µ –º–µ—Å—è—Ü–∞:** –î–æ–±–∞–≤–∏—Ç—å rate limiting –Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ endpoints
4. **–ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ:** –£–ª—É—á—à–∞—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å N+1 –∑–∞–ø—Ä–æ—Å—ã

